<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/base-layout.html}">
<head>
<title>Trang chủ</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Link CSS -->
<div layout:fragment="headerFiles">
	<link rel="stylesheet" href="/css/assets/light/apps/blog-post.css">
	<link rel="stylesheet" href="/css/assets/dark/apps/blog-post.css">
	<link rel="stylesheet"
		href="/css/assets/dark/apps/ecommerce-create.css">
	<link rel="stylesheet"
		href="/css/assets/light/apps/ecommerce-create.css">
	<link rel="stylesheet" type="text/css"
		href="/css/assets/dark/apps/blog-create.css">
	<link rel="stylesheet" type="text/css"
		href="/css/assets/light/apps/blog-create.css">

	<link rel="stylesheet" type="text/css"
		href="/css/plugins/light/tomSelect/custom-tomSelect.css">
	<link rel="stylesheet" type="text/css"
		href="/css/plugins/dark/tomSelect/custom-tomSelect.css">
	<link rel="stylesheet" type="text/css"
		href="/plugins/tomSelect/tom-select.default.min.css">

	<style>
.ts-control {
	padding: 12px;
}
/* Cấu trúc chung của toa tàu */
.train-layout {
	display: flex;
	justify-content: center;
	gap: 20px;
	padding: 20px 0;
}

.carriage {
	display: flex;
	flex-direction: column;
	align-items: center;
	gap: 10px;
	cursor: pointer;
	transition: transform 0.3s ease;
}

.carriage-content {
	position: relative;
	width: 150px;
	height: 80px;
	border-radius: 10px;
	background-color: #ADD8E6; /* Màu xanh dương nhạt cho toa */
	box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
	display: flex;
	justify-content: center;
	align-items: center;
	padding: 10px 0;
}

.carriage-content:hover {
	transform: translateY(-5px);
	box-shadow: 0 6px 10px rgba(0, 0, 0, 0.3);
	transition: transform 0.3s ease;
}

/* Hiệu ứng khi chọn toa */
.carriage.selected .carriage-content {
	background-color: #28a745; /* Màu xanh cây khi chọn toa */
	box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4); /* Bóng đổ mạnh hơn */
	transform: scale(1.1); /* Tăng kích thước toa khi chọn */
}

.carriage.selected .carriage-label {
	color: #28a745; /* Chữ màu xanh cây khi chọn toa */
}

/* Ô cửa sổ */
.windows {
	display: flex;
	justify-content: space-between;
	gap: 5px;
	width: 80%;
}

.window {
	width: 30px;
	height: 40px;
	background: #FFF;
	border-radius: 5px;
	box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

/* Nhãn Toa */
.carriage-label {
	font-weight: bold;
	font-size: 16px;
	color: #4CAF50;
	text-align: center;
	margin-top: 5px;
}

/* Các ghế trong toa */
.seat-display {
	background: #f8f9fa;
	border-radius: 10px;
	padding: 20px;
	box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
}

.seat-map {
	display: flex;
	flex-direction: column;
	align-items: center;
	gap: 15px;
	margin-top: 20px;
}

.seat-row {
	display: flex;
	gap: 10px;
}

.seat {
	width: 50px;
	height: 50px;
	background-color: #fff; /* Màu ghế mặc định là trắng */
	color: #000;
	font-size: 14px;
	display: flex;
	justify-content: center;
	align-items: center;
	border-radius: 5px;
	cursor: pointer;
	border: 1px solid #999; /* Viền ghế màu xanh cây */
	transition: background-color 0.3s, transform 0.2s;
}

/* Khi ghế được chọn */
.seat.selected {
	background-color: #007bff; /* Màu xanh dương khi chọn ghế */
	transform: scale(1.1); /* Tăng kích thước khi chọn */
}

/* Màu ghế khi hover */
.seat:hover:not(.booked):not(.selected) {
	background-color: #ffc107; /* Màu vàng khi hover */
	transform: scale(1.1); /* Tăng kích thước khi hover */
}

.seat.booked {
	background-color: #dc3545;
	cursor: not-allowed;
}

.btn-confirm {
	margin-top: 20px;
	padding: 12px 20px;
	font-size: 16px;
	font-weight: bold;
}
</style>

</div>


</head>
<body>
	<!-- Nội dung chính -->
	<div layout:fragment="content">
		<div class="middle-content container-xxl p-0">
			<!-- BREADCRUMB -->
			<div class="page-meta">
				<nav class="breadcrumb-style-one" aria-label="breadcrumb">
					<ol class="breadcrumb">
						<li class="breadcrumb-item"><a th:href="@{/dashboard/index}">Tra
								cứu</a></li>
						<li class="breadcrumb-item" aria-current="page">Danh sách
							chuyến đi</li>
						<li class="breadcrumb-item active" aria-current="page">Chi
							tiết chuyến đi</li>
					</ol>
				</nav>
			</div>
			<!-- /BREADCRUMB -->
			<div class="row layout-top-spacing">
				<div class="col-xxl-3 col-xl-3 col-lg-3 col-md-3 col-sm-12 mb-4">
					<div
						class="widget-content widget-content-area ecommerce-create-section">
						<div
							class="header text-center text-white mb-3 p-1 rounded border border-primary">
							<p class="mb-0 text-primary fs-4">Thông tin chuyến đi</p>
						</div>
						<div class="text-center mb-4">
							<img src="/images/van-tai-duong-sat.jpg" alt="Ship Image"
								class="img-fluid rounded" style="max-width: 100%;">
						</div>
						<div class="row">
							<div class="col-xxl-12">
								<div class="d-flex">
									<p class="text-start me-1">Tàu :</p>
									<b><p class="text-dark text-bold"
											th:text="${schedule != null ? schedule.route.train.trainName : ''}"></p></b>
								</div>
								<div class="d-flex">
									<p class="text-start me-1">Nơi đi :</p>
									<b><p class="text-dark text-bold"
											th:text="${schedule != null ? schedule.route.departureLocation.displayName : ''}"></p></b>
								</div>
								<div class="d-flex">
									<p class="text-start me-1">Nơi đến :</p>
									<b><p class="text-dark text-bold"
											th:text="${schedule != null ? schedule.route.destinationLocation.displayName  : ''}"></p></b>
								</div>
								<div class="d-flex">
									<p class="text-start me-1">Thời gian đi :</p>
									<b><p class="text-dark text-bold"
											th:text="${#temporals.format(schedule.departureDate, 'HH:mm, dd/MM/yyyy')}"></p></b>
								</div>
								<div class="d-flex">
									<p class="text-start me-1">Thời gian đến :</p>
									<b><p class="text-dark text-bold"
											th:text="${#temporals.format(schedule.estimateArrivalDate, 'HH:mm, dd/MM/yyyy')}"></p></b>
								</div>

							</div>
						</div>
					</div>
				</div>



				<div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 mb-4">
					<div class="single-post-content">
						<div class="container">
							<h4 class="mb-4 text-center">Danh sách toa và ghế</h4>
							<hr>
							<div class="alert alert-info mt-4" role="alert">
								<div class="d-flex align-items-center">
									<i class="bi bi-info-circle-fill me-2 text-primary fs-5"></i>
									<p class="mb-0">
										<strong>Lưu ý:</strong> Nếu gặp khó khăn, hãy liên hệ tổng đài
										<strong>1800-1234</strong> để được hỗ trợ thêm.
									</p>
								</div>
							</div>


							<div class="train-layout d-flex justify-content-center gap-3">
								<tr th:each="coach, stat : ${coaches}">

									<div class="carriage" th:data-carriage="${coach.id}">
										<div class="carriage-content">
											<div class="windows">
												<div class="window"></div>
												<div class="window"></div>
												<div class="window"></div>
											</div>
										</div>
										<span class="carriage-label" th:text="${coach.coachName}"></span>
									</div>


								</tr>



							</div>


							<!-- Ô lớn hiển thị ghế -->
							<div class="seat-display mt-4">
								<h5 id="carriage-title">Sơ đồ ghế: Toa 1</h5>
								<hr>
								<div class="d-flex justify-content-between align-items-center">
									<button class="btn btn-light-dark btn-sm" id="prevCarriage"><</button>
									<div class="seat-map" id="seat-map">
										<!-- Sơ đồ ghế sẽ được cập nhật qua JavaScript -->
									</div>
									<button class="btn btn-light-dark btn-sm" id="nextCarriage">></button>
								</div>
							</div>


						</div>

					</div>
				</div>



				<div class="col-xxl-3 col-xl-3 col-lg-3 col-md-3 col-sm-12 mb-4">
					<div
						class="widget-content widget-content-area ecommerce-create-section">
						<div
							class="header text-center text-white mb-3 p-1 rounded border border-primary">
							<p class="mb-0 text-primary fs-4">Giỏ vé</p>
						</div>


						<hr>
						<!-- Nút đặt vé -->
						<div class="d-flex justify-content-center">
							<button class="btn btn-primary" id="confirmBooking">Mua
								vé</button>
						</div>
					</div>

					<div
						class="widget-content widget-content-area ecommerce-create-section mt-3">
						<div
							class="header text-center text-white mb-3 p-1 rounded border border-primary">
							<p class="mb-0 text-primary fs-4">Tra cứu chuyến đi</p>
						</div>
						<form th:action="@{/schedule/index}" th:object="${searchSchedule}"
							method="post" id="general-settings">

							<div class="form-group mb-4">
								<label for="departureLocation">Nơi đi<strong
									class="text-danger">*</strong></label> <select
									th:field="*{departureLocation}" id="departureLocation"
									class="form-control"
									th:classappend="${#fields.hasErrors('departureLocation') ? 'is-invalid' : ''}">
									<option value="">Chọn nơi đi</option>
									<option th:each="province : ${provinces}"
										th:value="${province}" th:text="${province.displayName}"></option>
								</select> <span th:if="${#fields.hasErrors('departureLocation')}"
									class="text-danger" th:errors="*{departureLocation}"></span>
							</div>

							<div class="form-group mb-4">
								<label for="destination">Nơi đến<strong
									class="text-danger">*</strong></label> <select
									th:field="*{destinationLocation}" id="destinationLocation"
									class="form-control"
									th:classappend="${#fields.hasErrors('destinationLocation') ? 'is-invalid' : ''}">
									<option value="">Chọn nơi đến</option>
									<option th:each="province : ${provinces}"
										th:value="${province}" th:text="${province.displayName}"></option>
								</select> <span th:if="${#fields.hasErrors('destinationLocation')}"
									class="text-danger" th:errors="*{destinationLocation}"></span>
							</div>

							<div class="form-group mb-4">
								<label for="departureDate">Ngày đi<strong
									class="text-danger">*</strong></label> <input type="date"
									th:field="*{departureDate}" id="departureDate"
									name="departureDate" class="form-control"
									placeholder="Chọn ngày bắt đầu"
									th:classappend="${#fields.hasErrors('departureDate') ? 'is-invalid' : ''}"
									required> <span
									th:if="${#fields.hasErrors('departureDate')}"
									class="text-danger" th:errors="*{departureDate}"></span>
							</div>

							<div class="d-flex justify-content-center">
								<button type="submit" class="btn btn-primary">Tìm kiếm</button>
							</div>
						</form>


					</div>
				</div>


			</div>


			<div class="col-xxl-12 col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-4">
				<div class="single-post-content">

					<div
						class="header text-center text-white p-1 rounded border border-primary">
						<p class="mb-0 text-primary fw-bold fs-2">QUY ĐỊNH ĐỔI, TRẢ VÉ</p>
					</div>

					<div class="post-content">

						<h4 class="mb-3">1. Thời gian cao điểm Tết: Mức khấu trừ đối
							với vé trả lại, đổi vé là 30% giá tiền in trên Thẻ lên tàu hỏa
							(vé).</h4>

						<p>- Từ ngày 21/01/2025 đến ngày 31/01/2025: đối với đoàn tàu
							số chẵn.</p>
						<p>- Từ ngày 01/02/2025 đến ngày 09/02/2025: đối với đoàn tàu
							số lẻ.</p>
						<p>(*) Thời gian đổi, trả vé</p>
						<p>- Hành khách đổi, trả vé cá nhân: chậm nhất trước giờ tàu
							chạy là 24 giờ.</p>
						<p class="mb-3">- Hành khách trả vé tập thể: chậm nhất trước
							giờ tàu chạy là 48 giờ.</p>

						<h4 class="mb-3">2. Ngoài thời gian quy định tại điểm (1.)
							nêu trên, mức khấu trừ phí, thời gian đổi, trả vé thực hiện như
							sau:</h4>

						<p>- Từ ngày 21/01/2025 đến ngày 31/01/2025: đối với đoàn tàu
							số chẵn.</p>
						<p>- Từ ngày 01/02/2025 đến ngày 09/02/2025: đối với đoàn tàu
							số lẻ.</p>
						<p>(*) Thời gian đổi, trả vé</p>
						<p>- Hành khách đổi, trả vé cá nhân: chậm nhất trước giờ tàu
							chạy là 24 giờ.</p>
						<p class="mb-3">- Hành khách trả vé tập thể: chậm nhất trước
							giờ tàu chạy là 48 giờ.</p>

						<h4 class="mb-3">3. Hình thức trả vé.</h4>

						<p>- Khi hành khách mua vé và thanh toán online qua website
							bán vé của Ngành Đường sắt, app bán vé hoặc các ứng dụng mua vé
							tàu hỏa của các đối tác thứ ba thì có thể trả vé online qua các
							website bán vé của Ngành Đường sắt hoặc đến trực tiếp nhà ga.</p>
						<p>- Khi hành khách mua vé bằng các hình thức khác, muốn đổi
							vé, trả vé hành khách đến trực tiếp nhà ga kèm theo giấy tờ tùy
							thân bản chính của người đi tàu (hoặc người mua vé) cho nhân viên
							đường sắt. Đồng thời, thông tin trên thẻ đi tàu phải trùng khớp
							với giấy tờ tùy thân của hành khách.</p>
						<p class="mb-3">Trân trọng cảm ơn!.</p>

					</div>

				</div>

			</div>
		</div>
	</div>

	<!-- Scripts -->
	<div layout:fragment="footerFiles">
		<script src="/plugins/tomSelect/tom-select.base.js"></script>
		<script src="/plugins/flatpickr/flatpickr.js"></script>
		<script src="/plugins/tomSelect/custom-tom-select.js"></script>

		<script>
			const today = new Date();
			const tomorrow = new Date(today);
			tomorrow.setDate(tomorrow.getDate() + 1);
			
			const formattedDate = tomorrow.toISOString().split('T')[0];
			
			document.getElementById("departureDate").setAttribute("min", formattedDate);
		</script>

		<script type="text/javascript">
			new TomSelect("#departureLocation", {
				create : true,
				sortField : {
					field : "text",
					direction : "asc"
				}
			});
			

			new TomSelect("#destinationLocation", {
				create : true,
				sortField : {
					field : "text",
					direction : "asc"
				}
			});
		</script>

		<script th:inline="none">
			const seatData = {
			    1: [['1A', '1B', '1C', '1D', '1E', '1F', '1G'], ['2A', '2B', '2C', '2D', '2E', '2F', '2G']],
			    2: [['3A', '3B', '3C', '3D', '3E', '3F', '3G'], ['4A', '4B', '4C', '4D', '4E', '4F', '4G']],
			    3: [['5A', '5B', '5C', '5D', '5E', '5F', '5G'], ['6A', '6B', '6C', '6D', '6E', '6F', '6G']],
			    4: [['7A', '7B', '7C', '7D', '7E', '7F', '7G'], ['8A', '8B', '8C', '8D', '8E', '8F', '8G']]
			};

			</script>

		<script>
		   
		 let currentCarriage = 1;
    
  

	    function displaySeats(carriageNumber) {
	        const seatMap = document.getElementById('seat-map');
	        const carriageTitle = document.getElementById('carriage-title');
	
	        carriageTitle.textContent = `Sơ đồ ghế: Toa ${carriageNumber}`;
	
	        seatMap.innerHTML = '';
	
	        seatData[carriageNumber].forEach(row => {
	            const rowDiv = document.createElement('div');
	            rowDiv.classList.add('seat-row');
	
	            row.forEach(seat => {
	                const seatDiv = document.createElement('div');
	                seatDiv.classList.add('seat', 'available'); 
	                seatDiv.textContent = seat;
	                
	                seatDiv.addEventListener('click', function() {
	                    // Kiểm tra xem ghế có phải đã được đặt không
	                    if (seatDiv.classList.contains('booked')) return; // Nếu ghế đã đặt, không làm gì thêm
	
	                    // Toggle chọn ghế
	                    seatDiv.classList.toggle('selected');
	                    if (seatDiv.classList.contains('selected')) {
	                        seatDiv.style.backgroundColor = '#007bff';  // Đặt màu xanh dương cho ghế khi chọn
	                        seatDiv.style.color = 'white'; // Đổi màu chữ thành trắng khi chọn ghế
	                    } else {
	                        seatDiv.style.backgroundColor = '';  // Xóa màu khi bỏ chọn
	                        seatDiv.style.color = ''; // Trả lại màu chữ mặc định
	                    }
	                    // Đảm bảo ghế đã chọn giữ màu
	                   
	                });
	                rowDiv.appendChild(seatDiv);
	            });
	
	            seatMap.appendChild(rowDiv);
	        });
	    }
	
	    // Gắn sự kiện click cho các toa
	    document.querySelectorAll('.carriage').forEach(carriage => {
	        carriage.addEventListener('click', function () {
	            const carriageNumber = this.getAttribute('data-carriage');
	            displaySeats(carriageNumber);
	
	            // Gỡ bỏ lớp 'selected' khỏi tất cả các toa
	            document.querySelectorAll('.carriage').forEach(function(c) {
	                c.classList.remove('selected');
	            });
	
	            // Thêm lớp 'selected' vào toa được chọn
	            carriage.classList.add('selected');
	
	            // Cập nhật lại số toa hiện tại
	            currentCarriage = carriageNumber;
	        });
	    });
	
	    // Gắn sự kiện cho các nút điều hướng
	    document.getElementById('prevCarriage').addEventListener('click', () => {
	        if (currentCarriage > 1) {
	            currentCarriage--;
	            displaySeats(currentCarriage);
	
	            // Gỡ bỏ lớp 'selected' khỏi tất cả các toa
	            document.querySelectorAll('.carriage').forEach(function(c) {
	                c.classList.remove('selected');
	            });
	
	            // Thêm lớp 'selected' vào toa mới
	            document.querySelector(`.carriage[data-carriage="${currentCarriage}"]`).classList.add('selected');
	        }
	    });
	
	    document.getElementById('nextCarriage').addEventListener('click', () => {
	        if (currentCarriage < Object.keys(seatData).length) {
	            currentCarriage++;
	            displaySeats(currentCarriage);
	
	            // Gỡ bỏ lớp 'selected' khỏi tất cả các toa
	            document.querySelectorAll('.carriage').forEach(function(c) {
	                c.classList.remove('selected');
	            });
	
	            // Thêm lớp 'selected' vào toa mới
	            document.querySelector(`.carriage[data-carriage="${currentCarriage}"]`).classList.add('selected');
	        }
	    });
	    
	  
	    // Hiển thị mặc định ghế toa 1
	    displaySeats(1);
	    
		</script>

	</div>
</body>
</html>